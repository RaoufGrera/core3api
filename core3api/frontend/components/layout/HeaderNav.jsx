export { HeaderNav };
import { useState, useEffect, useRef } from 'react';
import { useTranslation } from "next-i18next";
import { accountService } from "../../src/_services";
import { Link } from 'components';
import getConfig from 'next/config';
import { useRouter } from 'next/router';


const { publicRuntimeConfig } = getConfig();

//const baseUrl = `${publicRuntimeConfig.apiUrl}/users`;
const baseUrl = `${publicRuntimeConfig.imgUrl}`;
function HeaderNav({ userData }) {
	const [isListOpen, setIsListOpen] = useState(false);
	const [isProfileListOpen, setIsProfileListOpen] = useState(false);
	const ref = useRef(null);
	const { t } = useTranslation();
	const userId = accountService.accountValue.id;
	function toggleList() {
		setIsListOpen(!isListOpen)
	}
	function close() {
		setIsListOpen(false);
	};

	const router = useRouter()


	function toggleListProfile() {
		setIsProfileListOpen(!isProfileListOpen)
	}
	function closeProfile() {
		if (ref.current && !ref.current.contains(event.target)) {
			setIsProfileListOpen(false);
		};
	}
	function logout() {
		accountService.logout();
	}


	useEffect(() => {

		setTimeout(() => {
			if (isProfileListOpen) {
				window.addEventListener('click', closeProfile, true)
			}
			else {
				window.removeEventListener('click', closeProfile, true)
			}


		}, 400)
	})

	return (







		<nav className='shadow-sm  navbar sticky-top navbar-expand-md navbar-light bg-white p-0'>
			<div className="container-fluid px-1">

				<div id="navbarID" className=" navbar-collapse ">


					<ul className="menu navbar-nav mr-auto  mt-md-0">

						<li className=" dropdown account mr-0">

							<a ref={ref} onClick={toggleListProfile} id="link-header-account">
								<span className="portrait">
									{(userData) && <img src={`${baseUrl}/${userData.image}`} />}
								</span>

							</a>

							<ul className={isProfileListOpen ? "dropdown-content" : "dropdown-content hide"} >


								<li className="edit_profile ">
									<Link href={`/edit`}>

										<span>{t('edit_profile')}</span>

									</Link>
								</li>

								<li className="edit_profile ">
									<Link href={`/${userId}`}>

										<span>{t('profile')}</span>

									</Link>
								</li>

								<li><hr></hr></li>
								<div className='bg-light p-2 pb-0'>
									<li >
										<a onClick={() => {
											router.push('/en', '/en', { locale: 'en' })
										}}>
											English
										</a></li>
									<li className='pointer link' >
										<a onClick={() => {
											router.push('/', '/', { locale: 'ar' })
										}}>
											العربية</a>
									</li>
								</div>
								<li><hr></hr></li>

								<li className="settings  ">
									<Link href="setting">
										<svg className='app-icon' xmlns="http://www.w3.org/2000/svg" version="1.1" width="28" height="28" x="0" y="0" viewBox="0 0 128 128" xmlSpace="preserve" ><g><g xmlns="http://www.w3.org/2000/svg"><path d="M126.645,54.358l-9.979-2.315a53.474,53.474,0,0,0-6.99-16.807l5.436-8.72a1.75,1.75,0,0,0-.247-2.163l-11.22-11.22a1.749,1.749,0,0,0-2.163-.248L92.76,18.32a53.48,53.48,0,0,0-16.806-6.989L73.638,1.352A1.75,1.75,0,0,0,71.934,0H56.066a1.75,1.75,0,0,0-1.7,1.355l-2.316,9.979A53.48,53.48,0,0,0,35.24,18.32l-8.722-5.435a1.749,1.749,0,0,0-2.163.248l-11.22,11.22a1.75,1.75,0,0,0-.247,2.163l5.436,8.72a53.474,53.474,0,0,0-6.99,16.807l-9.98,2.315A1.751,1.751,0,0,0,0,56.064V71.931a1.751,1.751,0,0,0,1.354,1.7l9.98,2.315a53.474,53.474,0,0,0,6.99,16.807l-5.436,8.72a1.752,1.752,0,0,0,.247,2.164l11.22,11.219a1.749,1.749,0,0,0,2.163.248l8.722-5.435a53.456,53.456,0,0,0,16.806,6.989l2.316,9.98a1.75,1.75,0,0,0,1.7,1.354H71.934a1.75,1.75,0,0,0,1.7-1.354l2.316-9.98a53.456,53.456,0,0,0,16.806-6.989l8.722,5.435a1.749,1.749,0,0,0,2.163-.248l11.22-11.219a1.752,1.752,0,0,0,.247-2.164l-5.436-8.72a53.474,53.474,0,0,0,6.99-16.807l9.979-2.315a1.752,1.752,0,0,0,1.355-1.7V56.064A1.752,1.752,0,0,0,126.645,54.358ZM124.5,70.54l-9.706,2.252a1.75,1.75,0,0,0-1.319,1.354,50.063,50.063,0,0,1-7.331,17.629,1.75,1.75,0,0,0-.026,1.891l5.289,8.484-9.254,9.253-8.484-5.288a1.752,1.752,0,0,0-1.891.026,50.018,50.018,0,0,1-17.629,7.331,1.75,1.75,0,0,0-1.354,1.319L70.543,124.5H57.457l-2.252-9.706a1.752,1.752,0,0,0-1.354-1.319,50.01,50.01,0,0,1-17.629-7.331,1.752,1.752,0,0,0-1.891-.026L25.847,111.4l-9.254-9.253,5.289-8.484a1.75,1.75,0,0,0-.026-1.891,50.044,50.044,0,0,1-7.331-17.629,1.75,1.75,0,0,0-1.319-1.354L3.5,70.54V57.454L13.206,55.2a1.749,1.749,0,0,0,1.319-1.353,50.041,50.041,0,0,1,7.331-17.63,1.75,1.75,0,0,0,.026-1.891l-5.289-8.484,9.254-9.253,8.484,5.288a1.75,1.75,0,0,0,1.891-.026,50.01,50.01,0,0,1,17.629-7.331A1.752,1.752,0,0,0,55.205,13.2L57.457,3.5H70.543L72.8,13.2a1.75,1.75,0,0,0,1.354,1.319,50.018,50.018,0,0,1,17.629,7.331,1.75,1.75,0,0,0,1.891.026l8.484-5.288,9.254,9.253-5.289,8.484a1.75,1.75,0,0,0,.026,1.891,50.06,50.06,0,0,1,7.331,17.63,1.749,1.749,0,0,0,1.319,1.353l9.706,2.252Z" fill="#666666" data-original="#666666"></path><path d="M64,30A34,34,0,1,0,98,64,34.038,34.038,0,0,0,64,30Zm0,64.5A30.5,30.5,0,1,1,94.5,64,30.534,30.534,0,0,1,64,94.5Z" fill="#666666" data-original="#666666"></path></g></g></svg>												<span>{t('setting')}</span>
									</Link>
								</li>

								<li onClick={logout} className="logout">
									<a id="link-header-logout"  >
										<svg className='app-icon' xmlns="http://www.w3.org/2000/svg" version="1.1" width="28" height="28" x="0" y="0" viewBox="0 0 64 64" xmlSpace="preserve" ><g>
											<g xmlns="http://www.w3.org/2000/svg" id="Exit_1_">
												<path d="M52.4501991,28.7678509l-5-4.9990005c-0.3768997-0.3770008-0.9902-0.3770008-1.3671989,0   c-0.3778992,0.3778992-0.3778992,0.9902,0,1.3671989l3.3171997,3.3164005H35.2666016v2h14.1320992l-3.3157005,3.3163986   c-0.3778992,0.377903-0.3778992,0.9902,0,1.3672028c0.1884995,0.1884995,0.4365997,0.2831993,0.6835976,0.2831993   c0.2471008,0,0.4951019-0.0946999,0.6836014-0.2831993l5-5.0010014c0.1817017-0.1816006,0.2831993-0.4277,0.2831993-0.6835995   C52.7333984,29.1946507,52.6319008,28.9495506,52.4501991,28.7678509z" fill="#666666" data-original="#666666"></path>
												<path d="M40.2666016,39.4524498c-0.5527,0-1,0.4473-1,1v10.7900009c0,1.0429993-0.8310013,2.2099991-1.9433022,2.2099991   h-6.0566998V11.2394505V9.8677502L30.0191994,9.33395L14.0765009,2.56445l-0.2606955-0.112h23.507494   c1.2168007,0,1.9433022,0.9921999,1.9433022,1.9511998v15.0487995c0,0.5527,0.4473,1,1,1c0.5527992,0,1-0.4473,1-1V4.4036498   c0-2.1786997-1.7685013-3.9511998-3.9433022-3.9511998H12.2666006c-0.5215998,0-0.9358997,0.4029-0.9822998,0.9124   L11.2666006,1.35725V1.45245V55.03405l17.1855011,7.3064003l2.8144989,1.2070999v-3.0951004v-5h6.0566998   c2.3584023,0,3.9433022-2.1767998,3.9433022-4.2099991V40.4524498   C41.2666016,39.8997498,40.8194008,39.4524498,40.2666016,39.4524498z M29.2665997,11.2394505v49.2129974l-15.999999-6.7766991   V4.4524498l15.9906988,6.7728004l0.0093002,0.0038996V11.2394505z" fill="#666666" data-original="#666666" className=""></path>
											</g></g>
										</svg>											<span>{t('logout')}</span>
									</a>
								</li>
							</ul>
						</li>
						<li className="nav-item active">
							<Link href="/">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path className="icon_svg-fill_as_stroke" d="M12 11.375c2.276 0 4.125 1.823 4.125 4.076V22.5c0 .345-.28.625-.625.625h-7a.625.625 0 0 1-.625-.625v-7.049c0-2.253 1.849-4.076 4.125-4.076zm-7-2c1.376 0 2.638.671 3.403 1.771a.625.625 0 1 1-1.027.713A2.884 2.884 0 0 0 5 10.624c-1.533 0-2.783 1.178-2.87 2.66l-.005.166-.001 8.424h4.127c.314 0 .574.231.618.533l.007.092a.624.624 0 0 1-.533.618l-.092.007H1.5a.624.624 0 0 1-.618-.533L.875 22.5v-9.049c0-2.253 1.849-4.076 4.125-4.076zm14.001 0c2.276 0 4.125 1.823 4.125 4.076V22.5l-.007.092a.626.626 0 0 1-.618.533H17.75l-.092-.007a.626.626 0 0 1-.533-.618l.007-.092a.626.626 0 0 1 .618-.533h4.126v-8.424l-.005-.166c-.087-1.482-1.337-2.66-2.87-2.66-.963 0-1.844.468-2.377 1.235a.625.625 0 1 1-1.027-.713A4.133 4.133 0 0 1 19 9.375zM12 12.625c-1.59 0-2.875 1.267-2.875 2.826v6.424h5.75v-6.424c0-1.503-1.195-2.735-2.706-2.821zm0-10a3.86 3.86 0 0 1 2.641 1.039c.743.652 1.234 1.541 1.234 2.461v.625A3.89 3.89 0 0 1 12 10.375a3.875 3.875 0 0 1-3.867-3.624l-.008-.001v-.625c0-.919.491-1.809 1.234-2.461A3.861 3.861 0 0 1 12 2.625zm2.613 4.126H9.387a2.625 2.625 0 0 0 5.226 0zM19.192.625h.158l.082.003.073.004.048.003.111.011.033.004-.144-.015a3.875 3.875 0 0 1 3.432 2.831 3.87 3.87 0 0 1 .135 1.237l-.002 2.176.022.188.025.152.012.06.059.012c.376.096.655.549.392.947l-.056.074a2.34 2.34 0 0 1-.429.381c-.848.596-1.86.578-2.695-.443l-.042-.053a3.87 3.87 0 0 1-3.362-.512.625.625 0 1 1 .712-1.028 2.626 2.626 0 0 0 2.672.188c.639-.453.834-1.328.415-2.046-.049-.097-.196-.263-.419-.458a7.85 7.85 0 0 0-.569-.448l-.819-.549-.042-.027-1.875 1.237a.625.625 0 0 1-.839-.14l-.053-.082-.452-.823a.63.63 0 0 1-.108-.321v-.02a.627.627 0 0 1 .056-.282A3.875 3.875 0 0 1 18.355.729l.042-.009.151-.032.03-.005.353-.046.06-.004.147-.007zm-14.505 0h.093l.103.002.086.004.118.008.104.01.072.009.123.019.082.014.07.014.314.079.042.013a3.85 3.85 0 0 1 .666.275c.148.079.292.167.429.264a3.86 3.86 0 0 1 .649.578l.113.132c.102.125.195.254.28.39l.057.094.005.009a3.89 3.89 0 0 1 .186.359.667.667 0 0 1 .048.158c.05.216.042.44-.018.634-.134.503-.531.948-1.088.948-.372 0-.678-.203-1.034-.56l-.354-.392-.158-.198-.309.253c-.297.23-.612.446-.949.649l-.344.198a6.762 6.762 0 0 1-1.882.491 2.62 2.62 0 0 0 1.04 1.56 2.626 2.626 0 0 0 3.014.018.625.625 0 1 1 .712 1.028 3.876 3.876 0 0 1-6.071-3.48 3.86 3.86 0 0 1 .248-1.099l.026-.064.047-.112.04-.087.023-.049.036-.072.025-.048.057-.103.03-.052.064-.104.048-.074.062-.09.054-.074.056-.073.07-.087.054-.063.063-.071.068-.072.069-.07.069-.066.063-.058.097-.084.047-.039.086-.068.074-.056.091-.065.066-.044.099-.063.063-.038.103-.059.072-.038.087-.044.095-.045.089-.039.094-.039.072-.028.116-.041.062-.02.151-.045.2-.049-.189.046.18-.044.027-.006.152-.029.082-.013.113-.015.067-.007.09-.008.058-.004L4.55.63l.096-.004z" fill="#666"></path></svg>
							</Link>

						</li>

						<li className="nav-item">

							<Link href="/chat">
								<span id='chat' className='badge'>{userData.messages}</span>

								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path className="icon_svg-fill_as_stroke" d="M20.582 1.469a2.757 2.757 0 0 1 1.369 4.468l-.134.143L7.594 20.299a.615.615 0 0 1-.129.099l-.073.036-1.238.514.006.006-.1.033-3.82 1.59a.615.615 0 0 1-.662-.116l-.058.019.019-.058a.615.615 0 0 1-.147-.569l.031-.093 1.592-3.831.031-.089.005.005.515-1.237a.637.637 0 0 1 .081-.141l.054-.061L17.92 2.182a2.756 2.756 0 0 1 2.662-.713zm.918 8.406c.314 0 .574.231.618.533l.007.092v11a.624.624 0 0 1-.533.618l-.092.007h-11a.625.625 0 0 1-.092-1.243l.092-.007h10.375V10.5c0-.314.231-.574.533-.618l.092-.007zm-2.577-6.916-.119.107L4.673 17.201l-.666 1.6 1.19 1.19 1.601-.665 14.136-14.13c.304-.304.46-.72.439-1.14l-.016-.158-.033-.157a1.504 1.504 0 0 0-2.4-.782zM13.5 1.875a.625.625 0 0 1 .092 1.243l-.092.007H3.124L3.125 13.5a.624.624 0 0 1-.533.618l-.092.007a.624.624 0 0 1-.618-.533l-.007-.092v-11c0-.314.231-.574.533-.618l.092-.007h11z" fill="#666"></path></svg>
							</Link>
						</li>



						<li className='nav-item'>
							<Link href="/box">

								<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="24" height="24" viewBox="0 0 496 496.616" ><g><path xmlns="http://www.w3.org/2000/svg" d="m496.308594 99.199219-248-99.199219-248 99.199219v45.417969h48v288h80v64h240v-64h80v-288h48zm-49.535156-2.582031h-396.929688l198.464844-79.386719zm-190.464844 232c0 13.429687-5.074219 26.207031-14.273438 35.992187l-97.726562 103.832031v-279.648437l97.726562 103.832031c9.199219 9.78125 14.273438 22.558594 14.273438 35.992188zm-2.625 46.957031c1.503906-1.597657 2.921875-3.253907 4.257812-4.964844l85.964844 110.007813h-189.085938zm12.96875-19.804688c3.664062-8.488281 5.65625-17.691406 5.65625-27.152343 0-9.464844-1.992188-18.664063-5.65625-27.152344l85.65625-109.617188v273.527344zm101.65625-179.152343h16v32h-16zm-110.375 110.007812c-1.328125-1.714844-2.753906-3.367188-4.257813-4.96875l-98.855469-105.039062h189.078126zm-129.625-78.007812h-16v-32h16zm304 208h-64v-192h32v-64h-304v64h32v192h-64v-272h368zm-416-288v-16h464v16zm0 0" fill="#303030" ></path></g></svg>		</Link>
						</li>


						<li className="nav-item">

							<Link href="/notification">
								<span id='notifiction' className='badge'>{userData.likes}</span>

								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path className="icon_svg-fill_as_stroke" d="M7.526 20.785H2.79a.625.625 0 0 1-.625-.625v-2.87c0-.283.19-.53.463-.604a3.359 3.359 0 0 0 2.093-1.655c.207-.456.349-1.126.426-1.944a18.81 18.81 0 0 0 .044-2.578l-.025-.44a6.84 6.84 0 0 1 4.402-6.386 2.54 2.54 0 0 1 4.133-2.658 2.54 2.54 0 0 1 .692 2.678 6.866 6.866 0 0 1 4.346 6.415l-.022.381a19.11 19.11 0 0 0 .046 2.585c.076.811.214 1.476.415 1.932a3.376 3.376 0 0 0 2.079 1.657.625.625 0 0 1 .459.603v2.885c0 .345-.28.625-.625.625h-4.616a4.93 4.93 0 0 1-8.948 0zm1.432 0a3.68 3.68 0 0 0 6.084 0H8.958zm-1.155-1.25a.62.62 0 0 1 .273 0h7.847a.62.62 0 0 1 .273 0h4.269v-1.81a4.62 4.62 0 0 1-2.402-2.143l-.018-.037c-.272-.605-.439-1.399-.527-2.346a20.211 20.211 0 0 1-.05-2.758l.022-.371a5.594 5.594 0 0 0-4.219-5.418A6.03 6.03 0 0 0 12 4.485h-.089a6.048 6.048 0 0 0-1.291.186.713.713 0 0 1-.12.019c-2.358.657-4.083 2.813-4.087 5.331l.026.43c.042.89.037 1.847-.048 2.754-.089.945-.257 1.738-.548 2.377a4.623 4.623 0 0 1-2.428 2.161v1.793h4.389zm2.969-16.189a6.907 6.907 0 0 1 1.104-.111h.133c.402.006.796.048 1.178.121a1.29 1.29 0 0 0-2.078-1.409 1.29 1.29 0 0 0-.337 1.4z" fill="#666"></path></svg>
							</Link>
						</li>



					</ul>

				</div>
				<Link className="navbar-brand" href="/">
					<img width={120} className="logo" src='/logo.png' alt="myletter" />
					<img width={40} className="logo-sm" src='/logo-sm.png' alt="myletter" />

				</Link>
			</div>
		</nav>
	);
}